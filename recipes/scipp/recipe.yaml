context:
  name: scipp
  version: 24.09.1

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  git: https://github.com/scipp/scipp.git
  tag: ${{ version }}

build:
  number: 0
  script:
    env:
      GIT_VERSION_INFO: ${{ version }}
    content:
      - cmake --preset package-${{ target_platform }}
      - cmake --build --preset build
      - ctest --preset test
  skip:
    - match(python, "<3.10")
    - match(python, ">3.12")

requirements:
  build:
    - ${{ stdlib("c") }}
    - ${{ compiler('c') }}
    - ${{ compiler('cxx') }}
    - if: build_platform != target_platform
      then:
        - cross-python_${{ target_platform }}
        - python
    - cmake
    - conan ==1.64.1
    - ninja
    - ccache
    - ${{ "m2-git" if win }}
    - ${{ "git" if unix }}
  host:
    - python
    - numpy
    - tbb-devel
  run:
    - python

tests:
  - python:
      imports:
        - scipp
      pip_check: true
  - files:
      source:
        - pyproject.toml
        - tests/
    requirements:
      run:
        - bs4
        - h5py
        - hypothesis
        - numba
        - pandas
        - pytest
        - python-graphviz
        - scipy
        - xarray
    script:
      - python -m pytest -v tests

about:
  license: BSD-3-Clause
  summary: Multi-dimensional data arrays with labeled dimensions
  description: Multi-dimensional data arrays with labeled dimensions
  license_file: LICENSE
  homepage: https://scipp.github.io/
  repository: https://github.com/scipp/scipp
  documentation: https://scipp.github.io/

extra:
  recipe-maintainers:
    - MridulS
